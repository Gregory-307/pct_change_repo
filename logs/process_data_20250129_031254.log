2025-01-29 03:12:54,808 - INFO - Processing data with:
2025-01-29 03:12:54,808 - INFO - - Start date: 2014-08-01 00:00:00
2025-01-29 03:12:54,809 - INFO - - Prediction horizon: 10 days
2025-01-29 03:12:54,809 - INFO - - Train end: 2017-12-29 00:00:00
2025-01-29 03:12:54,810 - INFO - - Val end: 2018-12-28 00:00:00
2025-01-29 03:12:54,810 - INFO - - Enabled features: 472
2025-01-29 03:12:54,810 - INFO - 
Loading raw data...
2025-01-29 03:13:11,502 - INFO - 
Cleaning data...
2025-01-29 03:13:11,502 - INFO - Initial data shape: (11512867, 13)
2025-01-29 03:13:12,630 - INFO - Shape after removing missing company names: (11512867, 6)
2025-01-29 03:13:14,900 - INFO - Shape after removing days with < 8 stocks: (11460947, 6)
2025-01-29 03:13:14,900 - INFO - 
Pivoting data...
2025-01-29 03:13:14,900 - INFO - Pivoting data to wide format...
2025-01-29 03:13:19,036 - WARNING - Found 3952614 duplicate entries in pivot columns
2025-01-29 03:13:20,434 - WARNING - Sample duplicates:
          ASOFDATE          COMPANYNAME EXCHANGETICKER                         FACTORNAME  FACTORVALUE  PRICECLOSE
1793161 2014-08-01  Bavarian Nordic A/S      CPSE:BAVA             1 Yr Chg in Admissions          NaN     114.000
4403790 2014-08-01  Bavarian Nordic A/S         DB:BV3             1 Yr Chg in Admissions          NaN      15.271
1793199 2014-08-01  Bavarian Nordic A/S      CPSE:BAVA   1 Yr Chg in Number of Properties          NaN     114.000
4403828 2014-08-01  Bavarian Nordic A/S         DB:BV3   1 Yr Chg in Number of Properties          NaN      15.271
1793205 2014-08-01  Bavarian Nordic A/S      CPSE:BAVA  1 Yr Chg in Number of Restuarants          NaN     114.000
4403834 2014-08-01  Bavarian Nordic A/S         DB:BV3  1 Yr Chg in Number of Restuarants          NaN      15.271
1793200 2014-08-01  Bavarian Nordic A/S      CPSE:BAVA        1 Yr Chg in Number of Rooms          NaN     114.000
4403829 2014-08-01  Bavarian Nordic A/S         DB:BV3        1 Yr Chg in Number of Rooms          NaN      15.271
1793201 2014-08-01  Bavarian Nordic A/S      CPSE:BAVA       1 Yr Chg in Revenue per Room          NaN     114.000
4403830 2014-08-01  Bavarian Nordic A/S         DB:BV3       1 Yr Chg in Revenue per Room          NaN      15.271
2025-01-29 03:13:20,670 - WARNING - 991 duplicate entries with different FACTORVALUE values found
2025-01-29 03:13:23,190 - ERROR - Pivot operation failed
2025-01-29 03:13:23,190 - ERROR - Data shape before pivot: (9412670, 6)
2025-01-29 03:13:23,198 - ERROR - Duplicate count: 3952614
2025-01-29 03:13:23,850 - ERROR - Unique FACTORNAME values: 472
2025-01-29 03:13:24,050 - ERROR - Null values in FACTORNAME: 0
2025-01-29 03:13:24,050 - ERROR - Processing failed: Pivot failed: 'SIMPLEINDUSTRYDESCRIPTION'
Traceback (most recent call last):
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3791, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 152, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 181, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SIMPLEINDUSTRYDESCRIPTION'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_1_cleaning.py", line 97, in pivot_data
    df_pivot = df.pivot(
               ^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 9025, in pivot
    return pivot(self, index=index, columns=columns, values=values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\reshape\pivot.py", line 536, in pivot
    index_list = [data[idx] for idx in com.convert_to_list_like(index)]
                  ~~~~^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 3893, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3798, in get_loc
    raise KeyError(key) from err
KeyError: 'SIMPLEINDUSTRYDESCRIPTION'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_0_pipeline.py", line 62, in process_data
    pivoted_data = pivot_data(cleaned_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_1_cleaning.py", line 112, in pivot_data
    raise ValueError(f"Pivot failed: {str(e)}") from e
ValueError: Pivot failed: 'SIMPLEINDUSTRYDESCRIPTION'
2025-01-29 03:13:24,060 - ERROR - Pipeline failed
Traceback (most recent call last):
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3791, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 152, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 181, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SIMPLEINDUSTRYDESCRIPTION'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_1_cleaning.py", line 97, in pivot_data
    df_pivot = df.pivot(
               ^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 9025, in pivot
    return pivot(self, index=index, columns=columns, values=values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\reshape\pivot.py", line 536, in pivot
    index_list = [data[idx] for idx in com.convert_to_list_like(index)]
                  ~~~~^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 3893, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3798, in get_loc
    raise KeyError(key) from err
KeyError: 'SIMPLEINDUSTRYDESCRIPTION'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_0_pipeline.py", line 119, in <module>
    process_data()
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_0_pipeline.py", line 62, in process_data
    pivoted_data = pivot_data(cleaned_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_1_cleaning.py", line 112, in pivot_data
    raise ValueError(f"Pivot failed: {str(e)}") from e
ValueError: Pivot failed: 'SIMPLEINDUSTRYDESCRIPTION'
