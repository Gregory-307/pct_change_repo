2025-01-29 01:35:55,225 - INFO - Processing data with:
2025-01-29 01:35:55,227 - INFO - - Start date: 2014-08-01 00:00:00
2025-01-29 01:35:55,227 - INFO - - Prediction horizon: 10 days
2025-01-29 01:35:55,228 - INFO - - Train end: 2017-12-29 00:00:00
2025-01-29 01:35:55,228 - INFO - - Val end: 2018-12-28 00:00:00
2025-01-29 01:35:55,228 - INFO - - Enabled features: 472
2025-01-29 01:35:55,228 - INFO - 
Loading raw data...
2025-01-29 01:36:13,317 - INFO - 
Cleaning data...
2025-01-29 01:36:13,318 - INFO - Initial data shape: (11512867, 13)
2025-01-29 01:36:13,908 - INFO - Shape after removing missing company names: (11512867, 13)
2025-01-29 01:36:16,988 - INFO - Shape after removing days with < 8 stocks: (11460947, 13)
2025-01-29 01:36:16,988 - INFO - \Pivoting data...
2025-01-29 01:36:16,990 - INFO - Pivoting data to wide format...
2025-01-29 01:36:21,491 - WARNING - Found 3952614 duplicate entries in pivot columns
2025-01-29 01:36:23,384 - WARNING - Sample duplicates:
          GVKEY  IID  COMPANYID  ...                         FACTORNAME  FACTORVALUE   ASOFDATE
1793161  247558  01W    7687618  ...             1 Yr Chg in Admissions          NaN 2014-08-01
4403790  247558  02W    7687618  ...             1 Yr Chg in Admissions          NaN 2014-08-01
1793199  247558  01W    7687618  ...   1 Yr Chg in Number of Properties          NaN 2014-08-01
4403828  247558  02W    7687618  ...   1 Yr Chg in Number of Properties          NaN 2014-08-01
1793205  247558  01W    7687618  ...  1 Yr Chg in Number of Restuarants          NaN 2014-08-01
4403834  247558  02W    7687618  ...  1 Yr Chg in Number of Restuarants          NaN 2014-08-01
1793200  247558  01W    7687618  ...        1 Yr Chg in Number of Rooms          NaN 2014-08-01
4403829  247558  02W    7687618  ...        1 Yr Chg in Number of Rooms          NaN 2014-08-01
1793201  247558  01W    7687618  ...       1 Yr Chg in Revenue per Room          NaN 2014-08-01
4403830  247558  02W    7687618  ...       1 Yr Chg in Revenue per Room          NaN 2014-08-01

[10 rows x 13 columns]
2025-01-29 01:36:23,818 - WARNING - 991 duplicate entries with different FACTORVALUE values found
2025-01-29 01:36:25,686 - WARNING - Sample duplicates:
          GVKEY  IID  COMPANYID  ...                         FACTORNAME  FACTORVALUE   ASOFDATE
1793161  247558  01W    7687618  ...             1 Yr Chg in Admissions          NaN 2014-08-01
4403790  247558  02W    7687618  ...             1 Yr Chg in Admissions          NaN 2014-08-01
1793199  247558  01W    7687618  ...   1 Yr Chg in Number of Properties          NaN 2014-08-01
4403828  247558  02W    7687618  ...   1 Yr Chg in Number of Properties          NaN 2014-08-01
1793205  247558  01W    7687618  ...  1 Yr Chg in Number of Restuarants          NaN 2014-08-01
4403834  247558  02W    7687618  ...  1 Yr Chg in Number of Restuarants          NaN 2014-08-01
1793200  247558  01W    7687618  ...        1 Yr Chg in Number of Rooms          NaN 2014-08-01
4403829  247558  02W    7687618  ...        1 Yr Chg in Number of Rooms          NaN 2014-08-01
1793201  247558  01W    7687618  ...       1 Yr Chg in Revenue per Room          NaN 2014-08-01
4403830  247558  02W    7687618  ...       1 Yr Chg in Revenue per Room          NaN 2014-08-01

[10 rows x 13 columns]
2025-01-29 01:36:34,423 - INFO - Pivoted data shape: (19943, 476)
2025-01-29 01:36:37,884 - INFO - 
Selecting features...
2025-01-29 01:36:37,884 - INFO - Selecting features...
2025-01-29 01:36:37,884 - INFO - Using 472 out of 472 enabled features
2025-01-29 01:36:37,899 - INFO - 
Calculating target...
2025-01-29 01:36:37,901 - INFO - Calculating 10-day forward returns...
2025-01-29 01:36:38,218 - INFO - Missing target values: 169 (0.8%)
2025-01-29 01:36:41,544 - INFO - 
Splitting data...
2025-01-29 01:36:41,544 - INFO - Splitting data...
2025-01-29 01:36:41,544 - ERROR - Processing failed: unsupported operand type(s) for &: 'Timestamp' and 'DatetimeArray'
Traceback (most recent call last):
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_0_pipeline.py", line 77, in process_data
    train_data, val_data, test_data = split_data(featured_data)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_2_feature_engineering.py", line 91, in split_data
    train = df[df['ASOFDATE'] >= DATA_PARAMS['train_start_date'] & df['ASOFDATE'] <= DATA_PARAMS['train_end_date']]
                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\arraylike.py", line 74, in __rand__
    return self._logical_method(other, roperator.rand_)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\series.py", line 5814, in _logical_method
    res_values = ops.logical_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\ops\array_ops.py", line 444, in logical_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\roperator.py", line 54, in rand_
    return operator.and_(right, left)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for &: 'Timestamp' and 'DatetimeArray'
2025-01-29 01:36:41,628 - ERROR - Pipeline failed
Traceback (most recent call last):
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_0_pipeline.py", line 106, in <module>
    process_data()
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_0_pipeline.py", line 77, in process_data
    train_data, val_data, test_data = split_data(featured_data)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\Downloads\Data\latest\pct_change\src\data_2_feature_engineering.py", line 91, in split_data
    train = df[df['ASOFDATE'] >= DATA_PARAMS['train_start_date'] & df['ASOFDATE'] <= DATA_PARAMS['train_end_date']]
                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\arraylike.py", line 74, in __rand__
    return self._logical_method(other, roperator.rand_)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\series.py", line 5814, in _logical_method
    res_values = ops.logical_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\ops\array_ops.py", line 444, in logical_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gregb\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\roperator.py", line 54, in rand_
    return operator.and_(right, left)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for &: 'Timestamp' and 'DatetimeArray'
